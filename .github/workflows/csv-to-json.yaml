name: "CSV to JSON Debug"

on:
  workflow_dispatch:
  push:
    branches:
      - main

permissions:
  contents: write

env:
  SOURCE_BRANCH: main
  TARGET_BRANCH: json

jobs:
  convert:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout source branch
        uses: actions/checkout@v4
        with:
          ref: ${{ env.SOURCE_BRANCH }}
          fetch-depth: 0

      - name: Checkout json-tools branch
        uses: actions/checkout@v4
        with:
          repository: ${{ github.repository }}
          ref: json-tools
          path: json-tools

      - name: List all files (Debug Step)
        run: |
          echo "Listing files in json-tools folder:"
          find json-tools -maxdepth 3
          echo "-----------------------------------"

      - name: Try Copying (Adjusted)
        run: |
          # سنحاول النسخ، وإذا فشل لن يتوقف الـ Action لكي نرى القائمة بالأعلى
          cp json-tools/csv_to_json.py . || echo "File not found in root"
          cp json-tools/tools/csv_to_json.py . || echo "File not found in tools folder"
